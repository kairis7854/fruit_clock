(this["webpackJsonpday994-fruit-clock"]=this["webpackJsonpday994-fruit-clock"]||[]).push([[0],{28:function(t,e,n){},30:function(t,e,n){},31:function(t,e,n){},32:function(t,e,n){},33:function(t,e,n){},34:function(t,e,n){},35:function(t,e,n){},36:function(t,e,n){},37:function(t,e,n){},38:function(t,e,n){},39:function(t,e,n){},40:function(t,e,n){},41:function(t,e,n){},42:function(t,e,n){},43:function(t,e,n){"use strict";n.r(e);var i=n(1),s=n.n(i),a=n(6),c=n.n(a),o=n(3),r=n(10),l="test",u="tomato",d="watermelon",j="strawberry",m="cantaloupe",b="nowMission";var h="TOMATO";var O={id:"",missoin:"",time:"",smoke:""};var f=Object(r.a)({test:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,n=e.type;switch(e.data,n){case l:return++t;default:return t}},fruit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,e=arguments.length>1?arguments[1]:void 0,n=e.type;switch(e.data,n){case u:return"TOMATO";case j:return"STRAWBERRY";case d:return"WATERMELON";case m:return"CANTALOUPE";default:return t}},mission:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,e=arguments.length>1?arguments[1]:void 0,n=e.type,i=e.data;switch(n){case b:return i;default:return t}}}),p=Object(r.b)(f),v=n(2),x=n(16),_=n.n(x),y=n(17),g=n(7),N=n(11),k=n(9);function C(){w.mission.bulkAdd([{id:1,mission:"\u6253\u75ab\u82d7",time:3,smoke:!1},{id:2,mission:"\u5403\u98ef",time:6,smoke:!1},{id:3,mission:"\u7761\u89ba",time:3,smoke:!1},{id:4,mission:"\u6253\u4ee3\u78bc",time:3,smoke:!1}])}var w=new(function(t){Object(N.a)(n,t);var e=Object(k.a)(n);function n(){var t;return Object(g.a)(this,n),(t=e.call(this,"FruitClockDB")).version(.1).stores({mission:"id,mission,time,smoke"}),t.version(.2).stores({mission:"id,mission,time,smoke",plan:"id,mission,time,smoke,[year+month+date],state"}),t}return n}(n(14).default));w.on("populate",C);n(28);var I=n(0);function M(){var t=Object(i.useState)(!1),e=Object(v.a)(t,2),n=e[0],s=e[1],a=function(){w.transaction("rw",w.mission,w.plan,Object(y.a)(_.a.mark((function t(){return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(w.tables.map((function(t){return t.clear()})));case 2:return t.next=4,C();case 4:case"end":return t.stop()}}),t)})))),window.location.reload()};return Object(I.jsxs)("div",{className:"Reset",children:[Object(I.jsx)("div",{className:"Reset__imgWrap",children:Object(I.jsx)("div",{className:"Reset__imgWrap__img",onClick:function(){s(!n)}})}),Object(I.jsxs)("div",{className:"Reset__question",style:{display:n?"block":"none"},children:[Object(I.jsx)("p",{children:"\u662f\u5426\u56de\u5230\u521d\u59cb\u72c0\u614b\uff1f"}),Object(I.jsx)("br",{}),Object(I.jsx)("input",{type:"button",value:"YES",onClick:function(){a()}}),Object(I.jsx)("input",{type:"button",value:"NO",onClick:function(){s(!1)}})]})]})}n(30);function T(t){var e=t.props,n=e.homeType,i=e.setHomeType;return Object(I.jsx)("div",{className:"CalendarButton",children:Object(I.jsx)("div",{className:"CalendarButton__CalendarButtonImgWrap",children:Object(I.jsx)("div",{className:"CalendarButton__CalendarButtonImgWrap__IMG",onClick:function(){i(!n)}})})})}n(31);function A(t){return Object(I.jsxs)("div",{className:"TopNav",children:[Object(I.jsx)(T,{props:t}),Object(I.jsx)(M,{})]})}n(32);var R=function(){var t=Object(o.b)();return Object(I.jsxs)("div",{className:"fruitButton",children:[Object(I.jsx)("button",{className:"fruitButton__tomatoButton",onClick:function(){t({type:u})},children:Object(I.jsx)("div",{className:"fruitButton__tomatoIMG"})}),Object(I.jsx)("button",{className:"fruitButton__strawberryButton",onClick:function(){t({type:j})},children:Object(I.jsx)("div",{className:"fruitButton__strawberryIMG"})}),Object(I.jsx)("button",{className:"fruitButton__watermelonButton",onClick:function(){t({type:d})},children:Object(I.jsx)("div",{className:"fruitButton__watermelonIMG"})}),Object(I.jsx)("button",{className:"fruitButton__cantaloupeButton",onClick:function(){t({type:m})},children:Object(I.jsx)("div",{className:"fruitButton__cantaloupeIMG"})})]})},F=s.a.memo(R),Y=n(4),B=n.p+"static/media/play-button.bb43f381.svg",L=n.p+"static/media/pause-button.a5abb526.svg",D=n.p+"static/media/blackout_harp1.c533454e.mp3",S=n.p+"static/media/blackout_harp2.b001a8e8.mp3",E=n.p+"static/media/tomato.7f1b1aa7.png",G=n.p+"static/media/strawberry.2289a785.png",W=n.p+"static/media/watermelon.1bee71d4.png",P=n.p+"static/media/cantaloupe.4727635b.png";n(33);function H(t){var e=t%60,n=parseInt(t/60),i=e<10?0:"";return["".concat(n<10?0:"").concat(n,":").concat(i).concat(e)]}var Q=new Audio(D),q=new Audio(S),J=function(t){var e=Object(o.c)((function(t){return t.mission})),n=Object(o.c)((function(t){return t.fruit})),s=Object(i.useState)(Number),a=Object(v.a)(s,2),c=a[0],r=a[1],l=Object(i.useState)(!1),u=Object(v.a)(l,2),d=u[0],j=u[1],m=Object(i.useState)({id:"",mission:"",time:"",smoke:""}),b=Object(v.a)(m,2),h=b[0],O=b[1],f=Object(I.jsx)("img",{src:E,style:{display:"TOMATO"===n?"block":"none"},alt:"fruit"}),p=Object(I.jsx)("img",{src:G,style:{display:"STRAWBERRY"===n?"block":"none"},alt:"fruit"}),x=Object(I.jsx)("img",{src:W,style:{display:"WATERMELON"===n?"block":"none"},alt:"fruit"}),_=Object(I.jsx)("img",{src:P,style:{display:"CANTALOUPE"===n?"block":"none"},alt:"fruit"}),y=Object(I.jsx)("img",{className:"clock__mission__switch",src:L,onClick:function(){N()},style:{display:t.isRun?"block":"none"},alt:"icon_pause"}),g=Object(I.jsx)("img",{className:"clock__mission__switch",src:B,onClick:function(){k()},style:{display:t.isRun?"none":"block"},alt:"icon_pause"});Object(i.useEffect)((function(){w.mission.toArray().then((function(t){O({id:t[0]?t[0].id:0,mission:t[0]?t[0].mission:"\u4efb\u52d9",time:t[0]?t[0].time:0,smoke:!!t[0]&&t[0].smoke})}))}),[]),Object(i.useEffect)((function(){O(e)}),[e]),Object(i.useEffect)((function(){var e;return t.isRun?e=setInterval((function(){r((function(t){return t-1}))}),1e3):clearInterval(e),function(){return clearInterval(e)}}),[t.isRun]),Object(i.useEffect)((function(){if(!d&&t.isRun&&0===c)return r(2),j(!0),void Q.play();d&&0===c&&(t.setIsRun(!t.isRun),j(!1),q.play(),w.mission.delete(h.id),w.plan.update(h.id,{state:"done"}),O({mission:"\u5b8c\u6210",time:0}))}),[c]);var N=function(){t.setIsRun(!t.isRun),O(Object(Y.a)(Object(Y.a)({},h),{},{time:c,smoke:!!d})),w.mission.put({id:h.id,mission:h.mission,time:c,smoke:!!d}),j(!1)},k=function(){0!==h.id?"\u5b8c\u6210"!==h.mission?(!0===h.smoke&&j(!0),t.setIsRun(!t.isRun),r(h.time)):alert("\u4efb\u52d9\u5df2\u5b8c\u6210!\u8acb\u9078\u64c7\u65b0\u7684\u4efb\u52d9\u3002"):alert("\u8acb\u5275\u5efa\u65b0\u7684\u4efb\u52d9\u3002")};return Object(I.jsxs)("div",{className:"clock",children:[Object(I.jsxs)("div",{className:"clock__mission",children:[d?"\u4f11\u606f":h.mission,d?null:h.smoke&&"(\u4f11\u606f)",y,g]}),Object(I.jsxs)("div",{className:"clock__fruitIMG",children:[f,p,x,_,Object(I.jsx)("p",{className:"clock__fruitIMG__time",children:t.isRun?H(c):H(h.time)})]})]})},U=n.p+"static/media/shopping-list.aadce41e.svg",$=n.p+"static/media/plus.b03e3495.svg",V=n(5);n(34);function z(){var t=new Date,e=t.getDate(),n=t.getMonth()+1;return{year:t.getFullYear(),month:n,date:e}}var K=function(t){var e=Object(V.useLiveQuery)((function(){return w.mission.toArray()})),n=Object(V.useLiveQuery)((function(){return w.plan.where({year:z().year,month:z().month,date:z().date}).and((function(t){return"wait"===t.state})).toArray()}),[]),s=Object(o.b)();return Object(i.useEffect)((function(){n&&n.length>0&&n.forEach((function(t,e){w.mission.add({id:t.id,mission:t.mission,time:2*t.time,smoke:!1}),w.plan.update(t.id,{state:"start"}),console.log("a")}))}),[n]),Object(I.jsxs)("div",{className:"list",children:[Object(I.jsx)("div",{className:"list__iconList",children:Object(I.jsx)("img",{src:U,className:"list__iconList__IMG",alt:"logo"})}),Object(I.jsx)("ul",{className:"list__ul",children:e?e.map((function(e){return Object(I.jsx)("li",{className:"list__ul__li",onClick:function(){!function(e){t.isRun||s({type:b,data:e})}(e)},children:e.mission},e.id)})):null}),Object(I.jsx)("div",{className:"list__iconAdd",onClick:function(){t.setListType(!0)},children:Object(I.jsx)("img",{src:$,className:"list__iconAdd__IMG",alt:"logo"})})]})};function X(t,e){return t.isRun===e.isRun}var Z=s.a.memo(K,X),tt=n(8),et=(n(35),/^\d*?$/),nt=function(t){var e=new Date,n=Object(i.useState)({mission:"",time:""}),s=Object(v.a)(n,2),a=s[0],c=s[1],o=function(t){"time"!==t.target.name||et.test(t.target.value)?c(Object(Y.a)(Object(Y.a)({},a),{},Object(tt.a)({},t.target.name,t.target.value))):alert("\u8acb\u8f38\u5165\u6578\u5b57")};return Object(I.jsxs)("div",{className:"ListAdd",children:[Object(I.jsx)("div",{className:"ListAdd__iconAdd",children:Object(I.jsx)("img",{src:$,className:"ListAdd__iconAdd__IMG",alt:"logo"})}),Object(I.jsxs)("form",{className:"ListAdd__form",onSubmit:function(t){t.preventDefault(),a.mission&&a.time?a.time>9999?alert("\u6642\u9593\u4e0d\u80fd\u8d85\u904e9999\u5206\u9418!"):(w.mission.add({id:e.getTime(),mission:a.mission,time:2*a.time,smoke:!1}),c({mission:"",time:""}),alert("\u6dfb\u52a0\u4efb\u52d9\u6210\u529f!")):alert("\u4efb\u52d9\u540d\u7a31\u6216\u6642\u9593\u4e0d\u80fd\u70ba\u7a7a!")},children:[Object(I.jsxs)("label",{children:["\u4efb\u52d9\uff1a",Object(I.jsx)("br",{}),Object(I.jsx)("input",{name:"mission",type:"text",value:a.mission,onChange:o,autoComplete:"off"})]}),Object(I.jsx)("br",{}),Object(I.jsxs)("label",{children:["\u6642\u9593(\u5206)\uff1a",Object(I.jsx)("input",{name:"time",type:"text",value:a.time,onChange:o.bind(undefined),autoComplete:"off"})]}),Object(I.jsx)("button",{children:"\u78ba\u5b9a"})]}),Object(I.jsx)("div",{className:"ListAdd__iconList",onClick:function(){t.setListType(!1)},children:Object(I.jsx)("img",{src:U,className:"ListAdd__iconList__IMG",alt:"logo"})})]})};n(36);function it(t){var e=t.isRun,n=Object(i.useState)(!1),s=Object(v.a)(n,2),a=s[0],c=s[1];return Object(I.jsxs)("div",{className:"list",children:[Object(I.jsx)("div",{style:{display:a?"none":"block"},children:Object(I.jsx)(Z,{isRun:e,setListType:c})}),Object(I.jsx)("div",{style:{display:a?"block":"none"},children:Object(I.jsx)(nt,{setListType:c})})]})}n(37);var st=function(t){var e=Object(i.useState)(!1),n=Object(v.a)(e,2),s=n[0],a=n[1];return Object(I.jsxs)("div",{className:"Main",style:{opacity:t.homeType?1:0,display:t.homeType?"flex":"none"},children:[Object(I.jsx)("div",{className:"Main__FuitButton",children:Object(I.jsx)(F,{})}),Object(I.jsx)("div",{className:"Main__Clock",children:Object(I.jsx)(J,{isRun:s,setIsRun:a})}),Object(I.jsx)("div",{className:"Main__List",children:Object(I.jsx)(it,{isRun:s})})]})},at=n(18),ct=(n(38),/^\d*?$/),ot=function(t){var e=Object(i.useState)(""),n=Object(v.a)(e,2),s=n[0],a=n[1],c=Object(i.useState)(""),o=Object(v.a)(c,2),r=o[0],l=o[1],u=function(t){a(t.target.value)},d=function(t){ct.test(t.target.value)?l(t.target.value):alert("\u8acb\u8f38\u5165\u6578\u5b57")},j=function(){if(s&&r)if(r>9999)alert("\u6642\u9593\u4e0d\u80fd\u8d85\u904e9999\u5206\u9418!");else{var e=new Date;w.plan.add({id:e.getTime(),mission:s,time:r,smoke:!1,year:t.timeInfo.year,month:t.timeInfo.month,date:t.timeInfo.date,state:"wait"}),alert("\u63d0\u4ea4\u6210\u529f"),a(""),l(""),t.closeForm()}else alert("\u4efb\u52d9\u540d\u7a31\u6216\u6642\u9593\u4e0d\u80fd\u70ba\u7a7a!")},m=Object(V.useLiveQuery)((function(){return w.plan.where({year:t.timeInfo.year,month:t.timeInfo.month,date:t.timeInfo.date}).toArray()}),[t.timeInfo]);return Object(I.jsxs)("div",{className:"CalendarForm",children:[Object(I.jsx)("div",{className:"CalendarForm__outside",onClick:t.closeForm}),Object(I.jsxs)("form",{className:"CalendarForm__inner",children:[Object(I.jsx)("div",{className:"CalendarForm__inner__date",children:t.timeInfo.date}),Object(I.jsxs)("div",{className:"CalendarForm__inner__plan",children:[Object(I.jsx)("strong",{children:" \u8a08\u5283\uff1a"}),Object(I.jsx)("ul",{children:m?m.map((function(t){return Object(I.jsxs)("li",{children:[t.mission,"/",t.time,"\u5206\u9418",Object(I.jsx)("div",{onClick:function(){var e;e=t.id,w.plan.delete(e)},children:"\u522a\u9664"})]},t.id)})):""})]}),function(){var e=t.timeInfo,n=e.initYear,i=e.initMonth,a=e.today,c=e.year,o=e.month,l=e.date,m=new Date(n,i-1,a),b=new Date(c,o-1,l);return m.getTime()<=b.getTime()?Object(I.jsxs)("div",{className:"CalendarForm__inner__addPlan",children:[Object(I.jsx)("strong",{children:" \u65b0\u589e\u8a08\u5283\uff1a"}),Object(I.jsxs)("div",{children:["\u540d\u7a31  ",Object(I.jsx)("input",{type:"text",name:"mission",autoComplete:"off",onChange:u.bind(undefined),value:s})]}),Object(I.jsxs)("div",{children:["\u6642\u9593  ",Object(I.jsx)("input",{type:"text",name:"time",autoComplete:"off",onChange:d,value:r,placeholder:"\u55ae\u4f4d:\u5206\u9418"})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("input",{type:"button",value:"\u53d6\u6d88",onClick:t.closeForm}),Object(I.jsx)("input",{type:"button",value:"\u63d0\u4ea4",onClick:j})]})]}):null}()]})]})},rt=(n(39),function(t){var e=Object(i.useState)(""),n=Object(v.a)(e,2),s=n[0],a=n[1];Object(i.useEffect)((function(){w.plan.where({year:t.dateInfo.year,month:t.dateInfo.month,date:t.dateInfo.date}).toArray().then((function(t){return a(t)}))}),[t.dateInfo]);var c=function(t){switch(t.state){case"wait":return Object(I.jsx)("strong",{style:{color:"purple"},children:"(\u7b49\u5f85)"});case"start":return Object(I.jsx)("strong",{style:{color:"blue"},children:"(\u53ef\u57f7\u884c)"});case"done":return Object(I.jsx)("strong",{style:{color:"green"},children:"(\u5b8c\u6210)"});case"fail":return Object(I.jsx)("strong",{style:{color:"red"},children:"(\u903e\u671f)"});default:return null}};return Object(I.jsx)(I.Fragment,{children:s?s.map((function(t,e){return Object(I.jsxs)("li",{className:"CalendarLiContent",children:[t.mission,c(t)]},e)})):null})});n(40);function lt(t){var e=t.toString();return 1===e.length&&(e="0".concat(e)),e}var ut=function(t){Object(N.a)(n,t);var e=Object(k.a)(n);function n(){var t;Object(g.a)(this,n);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return(t=e.call.apply(e,[this].concat(s))).state={initYear:"",initMonth:"",today:"",year:"",month:"",date:"",allDate:"",showForm:!1},t.changeYear=function(e){if("\u8acb\u9078\u64c7"!==e.target.value){var n=Number(e.target.value),i=new Date(n,t.state.month,0).getDate();t.setState({year:n,totalDate:i})}},t.changeMonth=function(e){if("\u8acb\u9078\u64c7"!==e.target.value){var n=Number(e.target.value),i=new Date(t.state.year,n,0).getDate();t.setState({month:n,totalDate:i})}},t.closeForm=function(){t.setState({showForm:!1})},t.openForm=function(e){t.setState({showForm:!0,date:e})},t}return Object(at.a)(n,[{key:"componentDidMount",value:function(){var t=new Date,e=t.getDate(),n=t.getMonth()+1,i=t.getFullYear(),s=new Date(i,n,0).getDate();this.setState({initYear:i,initMonth:n,today:e,year:i,month:n,date:e,totalDate:s}),w.plan.where("state").notEqual("done").and((function(t){return"".concat(t.year).concat(lt(t.month)).concat(lt(t.date))<"".concat(i).concat(lt(n)).concat(lt(e))})).modify({state:"fail"})}},{key:"render",value:function(){var t=this,e=this.props.homeType,n=new Array(this.state.totalDate).fill("").map((function(e,n){return Object(I.jsxs)("li",{className:"Calendar__ul__li",onClick:function(){t.openForm(n+1)},children:[Object(I.jsx)("div",{children:n+1}),Object(I.jsx)("ul",{className:"Calendar__ul__li__ul",children:Object(I.jsx)(rt,{dateInfo:{year:t.state.year,month:t.state.month,date:n+1}})})]},n+1)})),i=new Array(12).fill("").map((function(t,e){return Object(I.jsx)("option",{children:e+1},e+1)}));return Object(I.jsxs)("div",{className:"Calendar",style:{display:e?"none":"flex"},children:[Object(I.jsxs)("div",{className:"Calendar__Top",children:[Object(I.jsxs)("div",{className:"Calendar__Top__Year",children:[Object(I.jsx)("div",{children:this.state.year}),Object(I.jsx)("div",{children:"Year"}),Object(I.jsxs)("select",{onChange:this.changeYear,children:[Object(I.jsx)("option",{value:"\u8acb\u9078\u64c7",children:"\u8acb\u9078\u64c7"}),Object(I.jsx)("option",{value:this.state.initYear,children:this.state.initYear}),Object(I.jsx)("option",{value:this.state.initYear+1,children:this.state.initYear+1}),Object(I.jsx)("option",{value:this.state.initYear+2,children:this.state.initYear+2}),Object(I.jsx)("option",{value:this.state.initYear+3,children:this.state.initYear+3}),Object(I.jsx)("option",{value:this.state.initYear+4,children:this.state.initYear+4})]})]}),Object(I.jsxs)("div",{className:"Calendar__Top__Month",children:[Object(I.jsx)("div",{children:this.state.month}),Object(I.jsx)("div",{children:"Month"}),Object(I.jsxs)("select",{defaultValue:this.state.month,onChange:this.changeMonth,children:[Object(I.jsx)("option",{children:"\u8acb\u9078\u64c7"}),i]})]})]}),Object(I.jsx)("ul",{className:"Calendar__ul",children:n}),Object(I.jsx)("div",{className:"CalendarForm",style:{display:this.state.showForm?"block":"none"},children:Object(I.jsx)(ot,{closeForm:this.closeForm,timeInfo:{year:this.state.year,month:this.state.month,date:this.state.date,initYear:this.state.initYear,initMonth:this.state.initMonth,today:this.state.today}})})]})}}]),n}(i.Component);n(41);function dt(){var t=Object(i.useState)(!0),e=Object(v.a)(t,2),n=e[0],s=e[1];return Object(I.jsxs)("div",{className:"Home",children:[Object(I.jsx)(A,{homeType:n,setHomeType:s}),Object(I.jsx)(st,{homeType:n}),Object(I.jsx)(ut,{homeType:n})]})}n(42);var jt=function(){return Object(I.jsx)("div",{className:"app",children:Object(I.jsx)(dt,{})})};c.a.render(Object(I.jsx)(o.a,{store:p,children:Object(I.jsx)(jt,{})}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.c1ca4842.chunk.js.map